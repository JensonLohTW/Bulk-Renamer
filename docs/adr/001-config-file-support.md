# ADR 001: 支援大量檔案重新命名的設定檔架構

**日期**: 2026-02-21  
**狀態**: 提議中

## 背景
雖然命令列介面 (CLI) 能解決單次檔案重新命名的問題，但是當專案成長或使用者需要跨越多個資料夾、替換多組字串時，將過多的參數擠在命令列上容易出錯且不利於重複性操作。

## 決策
加入 JSON 設定檔支援（`config.json`），其架構與設計原則如下：

1. **無外部依賴 (JSON over YAML)**
   為了維持工具的輕量化與穩定性，使用 Python 標準庫 `json` 而不引入 `PyYAML`，避免新增相依套件所帶來的環境安裝負擔。
2. **資料結構與強型別**
   新增 `config.py` 並利用 `dataclass` 定義 `RenamerConfig`。解析 JSON 後立即轉換為實體物件，維持程式內部的強型別操作。
3. **配置優先層級**
   參數覆蓋規則為：`命令列參數 (CLI Args) > 設定檔 (JSON) > 預設值`。使用者可以在設定檔紀錄常用設定，但在單次執行時透過命令列覆蓋部分組態（例如：保留設定檔目錄，但臨時追加 `--dry-run`）。
4. **內建確認機制 (Confirmation Gate)**
   考量批次執行的破壞性，程式主入口 `cli.py` 需在正式執行（非 `--dry-run` 且使用 `--config` 時）自動列出即將生效的目錄清單與替換規則，要求使用者人工敲擊 `Y` 確認。
5. **核心迴圈遷移**
   `BulkRenamer` 即將接受 `target_dirs: list[str]`，並在內部 `run()` 由遍歷單一目錄拉升為遍歷多重目錄，維持一次跑完並產出單份 `RenameStats` 分析報告。

## 影響
* **正面**: 提供一鍵執行常規清理任務的能力，大幅減少輸入冗長指令的痛點；提升操作安全性（透過總結與人工確認）。
* **負面**: CLI 的 `argparse` 解析邏輯將稍微變得複雜，需區分出預設值與使用者實際傳入的值來與設定檔合併。
